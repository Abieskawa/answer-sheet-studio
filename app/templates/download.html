{% extends "base.html" %}
{% block content %}
<h1>{{ t.download_title }}</h1>
<form class="form" action="/api/generate" method="post">
  <label>{{ t.download_label_title }}
    <input type="text" name="title_text" placeholder="{{ t.download_ph_title }}" />
  </label>

  <label>{{ t.download_label_subject }}
    <input type="text" name="subject" placeholder="{{ t.download_ph_subject }}" />
  </label>

  <label>{{ t.download_label_class }}
    <input type="text" name="class_name" placeholder="{{ t.download_ph_class }}" />
  </label>

  <label>{{ t.download_label_num_questions }}
    <input type="number" name="num_questions" min="1" max="100" value="50" />
  </label>

  <label>{{ t.download_label_choices_count }}
    <select name="choices_count">
      <option value="3">ABC</option>
      <option value="4" selected>ABCD</option>
      <option value="5">ABCDE</option>
    </select>
  </label>

  <button type="submit">{{ t.download_btn_generate }}</button>

  <p class="hint">{{ t.download_hint_location }}</p>
  <p class="hint">{{ t.download_hint_support }}</p>
</form>

<script>
  (() => {
    const key = "answer_sheet_studio_num_questions";
    const input = document.querySelector('input[name="num_questions"]');
    if (!input) return;
    const saved = localStorage.getItem(key);
    if (saved && /^[0-9]+$/.test(saved)) input.value = saved;
    input.addEventListener("input", () => localStorage.setItem(key, input.value));
  })();

  (() => {
    const key = "answer_sheet_studio_choices_count";
    const select = document.querySelector('select[name="choices_count"]');
    if (!select) return;
    const saved = localStorage.getItem(key);
    if (saved && /^(3|4|5)$/.test(saved)) select.value = saved;
    select.addEventListener("change", () => localStorage.setItem(key, select.value));
  })();
</script>
{% endblock %}
